{"ast":null,"code":"import _slicedToArray from\"C:/Users/Shubham/whatsapp-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Avatar,IconButton}from\"@material-ui/core\";import SearchIcon from'@material-ui/icons/Search';import AttachFileIcon from'@material-ui/icons/AttachFile';import MoreVertIcon from'@material-ui/icons/MoreVert';import InsertEmoticonIcon from'@material-ui/icons/InsertEmoticon';import MicIcon from'@material-ui/icons/Mic';import{useParams}from\"react-router-dom\";import db from\"./firebase\";import'./Chat.css';import firebase from\"firebase\";import{useStateValue}from\"./StateProvider\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Chat(){var _messages,_messages$timestamp;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),seed=_useState4[0],setSeed=_useState4[1];var _useParams=useParams(),roomId=_useParams.roomId;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useStateValue=useStateValue(),_useStateValue2=_slicedToArray(_useStateValue,2),user=_useStateValue2[0].user,dispatch=_useStateValue2[1];useEffect(function(){if(roomId){db.collection(\"rooms\").doc(roomId).onSnapshot(function(snapshot){return setRoomName(snapshot.data().name);});db.collection(\"rooms\").doc(roomId).collection(\"messages\").orderBy(\"timestamp\",\"asc\").onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return doc.data();}));});}},[roomId]);useEffect(function(){setSeed(Math.floor(Math.random()*5000));},[roomId]);var sendMessage=function sendMessage(e){e.preventDefault();console.log(input);db.collection('rooms').doc(roomId).collection('messages').add({message:input,name:user.displayName,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setInput(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat__header\",children:[/*#__PURE__*/_jsx(Avatar,{src:\"https://avatars.dicebear.com/api/human/\".concat(seed,\".svg\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__headerInfo\",children:[/*#__PURE__*/_jsx(\"h3\",{children:roomName}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Last Seen \",\"\",new Date((_messages=messages[messages.length-1])===null||_messages===void 0?void 0:(_messages$timestamp=_messages.timestamp)===null||_messages$timestamp===void 0?void 0:_messages$timestamp.toDate()).toUTCString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__headerRight\",children:[/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(SearchIcon,{})]}),/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(AttachFileIcon,{})]}),/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(MoreVertIcon,{})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat__body\",children:messages.map(function(message){var _message$timestamp;return/*#__PURE__*/_jsxs(\"p\",{className:\"chat__message \".concat(message.name===user.displayName&&\"chat__reciever\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"chat__name\",children:message.name}),message.message,/*#__PURE__*/_jsx(\"span\",{className:\"chat__timestamp\",children:new Date((_message$timestamp=message.timestamp)===null||_message$timestamp===void 0?void 0:_message$timestamp.toDate()).toUTCString()})]});})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__footer\",children:[/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(InsertEmoticonIcon,{})]}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{value:input,type:\"text\",onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"Type a message\"}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,type:\"submit\",children:\"Send a message\"})]}),/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(MicIcon,{})]})]})]});}export default Chat;","map":{"version":3,"sources":["C:/Users/Shubham/whatsapp-clone/src/Chat.js"],"names":["React","useState","useEffect","Avatar","IconButton","SearchIcon","AttachFileIcon","MoreVertIcon","InsertEmoticonIcon","MicIcon","useParams","db","firebase","useStateValue","Chat","input","setInput","seed","setSeed","roomId","roomName","setRoomName","messages","setMessages","user","dispatch","collection","doc","onSnapshot","snapshot","data","name","orderBy","docs","map","Math","floor","random","sendMessage","e","preventDefault","console","log","add","message","displayName","timestamp","firestore","FieldValue","serverTimestamp","Date","length","toDate","toUTCString","target","value"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport { Avatar, IconButton } from \"@material-ui/core\";\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport MicIcon from '@material-ui/icons/Mic';\r\nimport { useParams } from \"react-router-dom\";\r\nimport db from \"./firebase\";\r\nimport './Chat.css';\r\nimport firebase from \"firebase\";\r\nimport { useStateValue } from \"./StateProvider\";\r\n\r\n\r\n\r\nfunction Chat() {\r\n    \r\n    const[input, setInput] = useState(\"\");\r\n    const [seed, setSeed] = useState(\"\");\r\n    const{ roomId } = useParams();\r\n    const [roomName, setRoomName] = useState(\"\");\r\n    const[messages, setMessages] = useState([]);\r\n    const [{user}, dispatch] = useStateValue();\r\n\r\n   useEffect(() =>{\r\n       if(roomId) {\r\n           db.collection(\"rooms\").doc(roomId).onSnapshot((snapshot) => setRoomName(snapshot.data().name)); \r\n\r\n           db.collection(\"rooms\").doc(roomId).collection(\"messages\").orderBy(\"timestamp\", \"asc\").onSnapshot((snapshot) => \r\n               setMessages(snapshot.docs.map((doc) => doc.data()))\r\n           );\r\n       }\r\n   }, [roomId]);\r\n\r\n    useEffect(() => {\r\n        setSeed(Math.floor(Math.random() * 5000));\r\n    }, [roomId]);\r\n\r\n    const sendMessage = (e) => {\r\n        e.preventDefault();\r\n        console.log(input);\r\n\r\n        db.collection('rooms').doc(roomId).collection('messages').add({\r\n            message: input,\r\n            name: user.displayName,\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n           });\r\n\r\n        setInput(\"\");\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"chat\">\r\n            \r\n            <div className=\"chat__header\">\r\n            <Avatar src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />\r\n            <div className=\"chat__headerInfo\">\r\n                <h3>{roomName}</h3>\r\n                <p>Last Seen {\"\"}\r\n                {new Date(\r\n                    messages[messages.length - 1]?.timestamp?.toDate()).toUTCString()}\r\n                </p>\r\n            </div>\r\n            <div className=\"chat__headerRight\">\r\n            <IconButton> <SearchIcon /></IconButton>\r\n            <IconButton> <AttachFileIcon/></IconButton>\r\n          <IconButton> <MoreVertIcon /></IconButton>\r\n\r\n            </div>\r\n            </div>\r\n    <div className=\"chat__body\">\r\n      {messages.map((message) => (\r\n        <p className={`chat__message ${\r\n            message.name === user.displayName\r\n             && \"chat__reciever\"}`}> \r\n      <span className=\"chat__name\">{message.name}</span>\r\n      {message.message}\r\n      <span className=\"chat__timestamp\">\r\n          {new Date(message.timestamp?.toDate()).toUTCString()}\r\n      </span>\r\n      </p>\r\n      ))}\r\n     \r\n      </div>\r\n    <div className=\"chat__footer\">\r\n       <IconButton> <InsertEmoticonIcon /></IconButton>\r\n       <form>\r\n           <input value={input} type=\"text\"  onChange={e => setInput(e.target.value)}\r\n               placeholder=\"Type a message\"\r\n           />\r\n           <button onClick={sendMessage} \r\n           type=\"submit\">Send a message</button>\r\n       </form>\r\n        <IconButton> <MicIcon /></IconButton>\r\n    </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat;\r\n"]},"metadata":{},"sourceType":"module"}